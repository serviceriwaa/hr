<!DOCTYPE html><html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>تحليل شامل للشركة</title>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: 'Cairo', sans-serif;
      background-color: #f1f5f9;
      color: #222;
      margin: 0;
      padding: 20px;
    }
    h1 {
      text-align: center;
      color: #004d7a;
    }
    form {
      max-width: 750px;
      margin: auto;
      background: #fff;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }
    label {
      font-weight: bold;
      display: block;
      margin-top: 20px;
    }
    input, textarea, select {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin-top: 8px;
    }
    button {
      background-color: #007acc;
      color: #fff;
      padding: 14px;
      margin-top: 25px;
      width: 100%;
      border: none;
      border-radius: 10px;
      font-size: 18px;
      cursor: pointer;
      font-weight: bold;
    }
    #result, #swot, #gauge_div, #plan, #market_analysis {
      max-width: 750px;
      margin: 30px auto;
      background-color: #e3f2fd;
      padding: 20px;
      border-radius: 12px;
      white-space: pre-line;
      color: #0d47a1;
    }
    #downloadPDF {
      background-color: #009688;
    }
  </style>
</head>
<body>
  <h1>📊 منصة تحليل أداء الشركات</h1>
  <form id="analysisForm">
    <label>اسم الشركة:</label>
    <input type="text" id="companyName" required><label>المدينة / العنوان:</label>
<input type="text" id="location" required>

<label>النشاط الرئيسي:</label>
<select id="mainActivity">
  <option value="صناعي">صناعي</option>
  <option value="تجاري">تجاري</option>
  <option value="خدمي">خدمي</option>
  <option value="زراعي">زراعي</option>
  <option value="أخرى">أخرى</option>
</select>

<label>نوع المنتج أو الخدمة:</label>
<input type="text" id="productType" placeholder="مثال: أثاث مكتبي، مواد غذائية، استشارات قانونية...">

<label>الإيرادات الشهرية:</label>
<input type="number" id="revenue" required>

<label>المصاريف الشهرية:</label>
<input type="number" id="expenses" required>

<label>عدد الموظفين:</label>
<input type="number" id="employees" required>

<label>متوسط الغياب اليومي:</label>
<input type="number" id="absent" required>

<label>إجمالي الإنتاج الشهري:</label>
<input type="number" id="production" required>

<label>نوع العملاء (B2B / أفراد / جهات حكومية):</label>
<input type="text" id="clientType">

<label>نقاط القوة المحتملة:</label>
<textarea id="strengths"></textarea>

<label>نقاط الضعف المحتملة:</label>
<textarea id="weaknesses"></textarea>

<label>الفرص الممكنة:</label>
<textarea id="opportunities"></textarea>

<label>التهديدات المحتملة:</label>
<textarea id="threats"></textarea>

<button type="submit">ابدأ التحليل</button>

  </form>  <div id="result"></div>
  <div id="gauge_div" style="width: 400px; height: 220px; margin: auto;"></div>
  <div id="plan"></div>
  <div id="swot"></div>
  <div id="market_analysis"></div>
  <button id="downloadPDF">تحميل التقرير PDF</button>  <script>
    google.charts.load('current', {'packages':['gauge']});

    document.getElementById("analysisForm").addEventListener("submit", function(e) {
      e.preventDefault();

      const name = document.getElementById("companyName").value;
      const location = document.getElementById("location").value;
      const activity = document.getElementById("mainActivity").value;
      const product = document.getElementById("productType").value;
      const revenue = parseFloat(document.getElementById("revenue").value);
      const expenses = parseFloat(document.getElementById("expenses").value);
      const employees = parseInt(document.getElementById("employees").value);
      const absent = parseInt(document.getElementById("absent").value);
      const production = parseFloat(document.getElementById("production").value);
      const clientType = document.getElementById("clientType").value;
      const profit = revenue - expenses;
      const absenceRate = ((absent / employees) * 100).toFixed(1);
      const productivity = ((production / (employees - absent))).toFixed(2);

      const performanceScore = Math.max(0, Math.min(100, ((profit > 0 ? 50 : 10) + (productivity * 2) - (absenceRate / 2))));

      const resultText = `🔍 تقرير أداء للشركة: ${name}

- النشاط: ${activity}
- المنتج/الخدمة: ${product}
- الإيرادات الشهرية: ${revenue}
- المصاريف الشهرية: ${expenses}
- الربح الشهري: ${profit}
- عدد الموظفين: ${employees}
- معدل الغياب: ${absenceRate}%
- إنتاجية الموظف: ${productivity} وحدة
\n✅ مؤشر الأداء العام: ${performanceScore.toFixed(0)} / 100`;

      document.getElementById("result").innerText = resultText;

      google.charts.setOnLoadCallback(function() {
        const data = google.visualization.arrayToDataTable([
          ['Label', 'Value'],
          ['الأداء', performanceScore]
        ]);
        const options = {
          width: 400, height: 220,
          redFrom: 0, redTo: 40,
          yellowFrom: 40, yellowTo: 70,
          greenFrom: 70, greenTo: 100,
          minorTicks: 5
        };
        const chart = new google.visualization.Gauge(document.getElementById('gauge_div'));
        chart.draw(data, options);
      });

      const planText = `📈 خطة عمل لتحسين الأداء:

1. تقليل المصروفات الغير ضرورية.
2. رفع إنتاجية الموظفين من خلال التدريب.
3. تحسين بيئة العمل لخفض الغياب.
4. تطوير التسويق الرقمي لجذب عملاء جدد.`;
      document.getElementById("plan").innerText = planText;

      const swotText = `🧠 تحليل SWOT مخصص:

✅ نقاط القوة:
${document.getElementById("strengths").value}

⚠️ نقاط الضعف:
${document.getElementById("weaknesses").value}

📈 الفرص:
${document.getElementById("opportunities").value}

🚨 التهديدات:
${document.getElementById("threats").value}`;
      document.getElementById("swot").innerText = swotText;

      const marketText = `🌍 تحليل السوق والموقع الجغرافي:

الموقع: ${location}
القطاع: ${clientType}
النشاط: ${activity}
المنتج/الخدمة: ${product}

🔎 عدد المنافسين في منطقتك: 6 شركات نشطة (تقديري)
📊 مؤشر التوسع في نوعية عملائك: متوسط
📌 توصية: ركّز على التميز في الخدمة الرقمية وخفض التكاليف للتميز عن المنافسين.`;
      document.getElementById("market_analysis").innerText = marketText;

      document.getElementById("downloadPDF").onclick = () => {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        doc.setFont("courier");
        doc.text(resultText + "\n\n" + planText + "\n\n" + swotText + "\n\n" + marketText, 10, 10, { maxWidth: 190 });
        doc.save("تحليل_أداء_الشركة.pdf");
      }
    });
  </script></body>
</html>
