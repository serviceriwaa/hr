<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<title>ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ø´Ø±ÙƒØªÙƒ - Ø±ÙˆØ§Ø¡</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  /* ØªØµÙ…ÙŠÙ… Ø¹ØµØ±ÙŠ Ù…ØªØ¬Ø§ÙˆØ¨ */
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f9fbfd;
    margin: 0; padding: 20px;
    color: #222;
  }
  h1 {
    text-align: center;
    color: #1a73e8;
    margin-bottom: 30px;
    font-weight: 700;
  }
  form {
    max-width: 720px;
    margin: auto;
    background: white;
    padding: 25px 30px;
    border-radius: 12px;
    box-shadow: 0 12px 30px rgba(26,115,232,0.15);
  }
  label {
    display: block;
    margin-top: 20px;
    font-weight: 600;
    color: #444;
  }
  input, select {
    margin-top: 8px;
    width: 100%;
    padding: 12px 14px;
    border: 1.8px solid #cbd5e1;
    border-radius: 8px;
    font-size: 1rem;
    transition: border-color 0.3s ease;
  }
  input:focus, select:focus {
    border-color: #1a73e8;
    outline: none;
  }
  select[multiple] {
    height: 130px;
  }
  .tooltip {
    margin-right: 6px;
    cursor: help;
    color: #1a73e8;
    font-weight: 700;
  }
  button {
    margin-top: 30px;
    width: 100%;
    padding: 14px 0;
    font-size: 1.15rem;
    font-weight: 700;
    color: white;
    background: #1a73e8;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    box-shadow: 0 6px 12px rgba(26,115,232,0.35);
    transition: background-color 0.3s ease;
  }
  button:hover {
    background: #155ab6;
  }
  .error {
    color: #e53935;
    font-size: 0.9rem;
    margin-top: 5px;
  }
  #result {
    max-width: 720px;
    margin: 40px auto 0;
    background: #e8f0fe;
    border-radius: 12px;
    padding: 25px 30px;
    white-space: pre-line;
    color: #1a237e;
    font-weight: 600;
    box-shadow: 0 6px 20px rgba(26,115,232,0.2);
  }
  #charts_container {
    max-width: 720px;
    margin: 40px auto 0;
    display: flex;
    justify-content: space-around;
    flex-wrap: wrap;
    gap: 40px;
  }
  #chart_div, #pie_chart_div {
    width: 340px;
    height: 320px;
  }
</style>
</head>
<body>

<h1>ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ø£Ø¯Ø§Ø¡ Ø´Ø±ÙƒØªÙƒ Ù…Ø¹ Ø®Ø·Ø© Ø¹Ù…Ù„ Ù…Ù‚ØªØ±Ø­Ø©</h1>

<form id="analysisForm" novalidate>

  <label><span class="tooltip" title="Ø§Ø³Ù… Ø´Ø±ÙƒØªÙƒ Ø§Ù„Ø±Ø³Ù…ÙŠ">â„¹ï¸</span>Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©</label>
  <input type="text" id="companyName" required placeholder="Ù…Ø«Ù„Ø§Ù‹: Ø±ÙˆØ§Ø¡ Ù„Ù„Ø§Ø³ØªØ´Ø§Ø±Ø§Øª">
  <div id="error-companyName" class="error"></div>

  <label><span class="tooltip" title="Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©">â„¹ï¸</span>Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</label>
  <input type="number" id="revenue" min="0" required placeholder="Ù…Ø«Ù„Ø§Ù‹: 150000">
  <div id="error-revenue" class="error"></div>

  <label><span class="tooltip" title="Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ Ø§Ù„Ø´Ù‡Ø±ÙŠØ©">â„¹ï¸</span>Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</label>
  <input type="number" id="expenses" min="0" required placeholder="Ù…Ø«Ù„Ø§Ù‹: 120000">
  <div id="error-expenses" class="error"></div>

  <label><span class="tooltip" title="Ø¹Ø¯Ø¯ Ù…ÙˆØ¸ÙÙŠ Ø´Ø±ÙƒØªÙƒ">â„¹ï¸</span>Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</label>
  <input type="number" id="employees" min="1" required placeholder="Ù…Ø«Ù„Ø§Ù‹: 25">
  <div id="error-employees" class="error"></div>

  <label><span class="tooltip" title="Ù…ØªÙˆØ³Ø· Ø¹Ø¯Ø¯ Ø§Ù„ØºÙŠØ§Ø¨ Ø§Ù„ÙŠÙˆÙ…ÙŠ">â„¹ï¸</span>Ù…ØªÙˆØ³Ø· Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„ØºØ§Ø¦Ø¨ÙŠÙ† ÙŠÙˆÙ…ÙŠÙ‹Ø§</label>
  <input type="number" id="avgAbsent" min="0" required placeholder="Ù…Ø«Ù„Ø§Ù‹: 3">
  <div id="error-avgAbsent" class="error"></div>

  <label><span class="tooltip" title="ÙƒÙ…ÙŠØ© Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ø´Ù‡Ø±ÙŠ">â„¹ï¸</span>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ø´Ù‡Ø±ÙŠ (ÙˆØ­Ø¯Ø§Øª Ø£Ùˆ Ø®Ø¯Ù…Ø§Øª)</label>
  <input type="number" id="production" min="0" required placeholder="Ù…Ø«Ù„Ø§Ù‹: 500">
  <div id="error-production" class="error"></div>

  <label><span class="tooltip" title="Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">â„¹ï¸</span>Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
  <input type="number" id="clientsCount" min="0" placeholder="Ù…Ø«Ù„Ø§Ù‹: 200">

  <label><span class="tooltip" title="Ø§Ø®ØªØ± Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ©">â„¹ï¸</span>Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ© (Ø§Ø®ØªØ± Ù…Ø§ ÙŠÙ†Ø·Ø¨Ù‚)</label>
  <select id="strengths" multiple>
    <option value="Ø®Ø¨Ø±Ø© Ø¹Ø§Ù„ÙŠØ© ÙÙŠ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©">Ø®Ø¨Ø±Ø© Ø¹Ø§Ù„ÙŠØ© ÙÙŠ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©</option>
    <option value="Ø¹Ù„Ø§Ù‚Ø§Øª Ù‚ÙˆÙŠØ© Ù…Ø¹ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡">Ø¹Ù„Ø§Ù‚Ø§Øª Ù‚ÙˆÙŠØ© Ù…Ø¹ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</option>
    <option value="Ø®Ø¯Ù…Ø§Øª ØªØ­Ù„ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©">Ø®Ø¯Ù…Ø§Øª ØªØ­Ù„ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©</option>
    <option value="ØªÙˆØ§Ø¬Ø¯ ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚ Ù„ÙØªØ±Ø© Ø·ÙˆÙŠÙ„Ø©">ØªÙˆØ§Ø¬Ø¯ ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚ Ù„ÙØªØ±Ø© Ø·ÙˆÙŠÙ„Ø©</option>
  </select>

  <label><span class="tooltip" title="Ø§Ø®ØªØ± Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù">â„¹ï¸</span>Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù (Ø§Ø®ØªØ± Ù…Ø§ ÙŠÙ†Ø·Ø¨Ù‚)</label>
  <select id="weaknesses" multiple>
    <option value="Ø¶Ø¹Ù ÙÙŠ Ø§Ù„ØªØ³ÙˆÙŠÙ‚ Ø§Ù„Ø±Ù‚Ù…ÙŠ">Ø¶Ø¹Ù ÙÙŠ Ø§Ù„ØªØ³ÙˆÙŠÙ‚ Ø§Ù„Ø±Ù‚Ù…ÙŠ</option>
    <option value="Ù†Ù‚Øµ ÙÙŠ Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ù„Ù„Ù…ÙˆØ¸ÙÙŠÙ†">Ù†Ù‚Øµ ÙÙŠ Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ù„Ù„Ù…ÙˆØ¸ÙÙŠÙ†</option>
    <option value="Ø§Ø¹ØªÙ…Ø§Ø¯ Ø¹Ø§Ù„ÙŠ Ø¹Ù„Ù‰ Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ø­Ø¯Ø¯ÙŠÙ†">Ø§Ø¹ØªÙ…Ø§Ø¯ Ø¹Ø§Ù„ÙŠ Ø¹Ù„Ù‰ Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ø­Ø¯Ø¯ÙŠÙ†</option>
    <option value="Ù…ÙˆØ§Ø±Ø¯ Ù…Ø§Ù„ÙŠØ© Ù…Ø­Ø¯ÙˆØ¯Ø©">Ù…ÙˆØ§Ø±Ø¯ Ù…Ø§Ù„ÙŠØ© Ù…Ø­Ø¯ÙˆØ¯Ø©</option>
  </select>

  <label><span class="tooltip" title="Ø§Ø®ØªØ± Ø§Ù„ÙØ±Øµ Ø§Ù„Ù…ØªØ§Ø­Ø©">â„¹ï¸</span>Ø§Ù„ÙØ±Øµ (Ø§Ø®ØªØ± Ù…Ø§ ÙŠÙ†Ø·Ø¨Ù‚)</label>
  <select id="opportunities" multiple>
    <option value="Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø·Ù„Ø¨ Ø¹Ù„Ù‰ Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©">Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø·Ù„Ø¨ Ø¹Ù„Ù‰ Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©</option>
    <option value="ØªÙˆØ³Ø¹ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø±Ù‚Ù…ÙŠ">ØªÙˆØ³Ø¹ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø±Ù‚Ù…ÙŠ</option>
    <option value="ØªØ·ÙˆÙŠØ± ØªÙ‚Ù†ÙŠØ§Øª ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª">ØªØ·ÙˆÙŠØ± ØªÙ‚Ù†ÙŠØ§Øª ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</option>
    <option value="Ø´Ø±Ø§ÙƒØ§Øª Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©">Ø´Ø±Ø§ÙƒØ§Øª Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©</option>
  </select>

  <label><span class="tooltip" title="Ø§Ø®ØªØ± Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯Ø§Øª Ø§Ù„ØªÙŠ ØªÙˆØ§Ø¬Ù‡Ù‡Ø§">â„¹ï¸</span>Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯Ø§Øª (Ø§Ø®ØªØ± Ù…Ø§ ÙŠÙ†Ø·Ø¨Ù‚)</label>
  <select id="threats" multiple>
    <option value="Ù…Ù†Ø§ÙØ³Ø© Ø´Ø¯ÙŠØ¯Ø© ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚">Ù…Ù†Ø§ÙØ³Ø© Ø´Ø¯ÙŠØ¯Ø© ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚</option>
    <option value="ØªØºÙŠØ±Ø§Øª ÙÙŠ Ø§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ†">ØªØºÙŠØ±Ø§Øª ÙÙŠ Ø§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ†</option>
    <option value="ØªØ±Ø§Ø¬Ø¹ ÙÙŠ Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯">ØªØ±Ø§Ø¬Ø¹ ÙÙŠ Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯</option>
    <option value="ØµØ¹ÙˆØ¨Ø© ÙÙŠ Ø¬Ø°Ø¨ Ø§Ù„Ù…ÙˆØ§Ù‡Ø¨">ØµØ¹ÙˆØ¨Ø© ÙÙŠ Ø¬Ø°Ø¨ Ø§Ù„Ù…ÙˆØ§Ù‡Ø¨</option>
  </select>

  <button type="submit">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ù„ÙŠÙ„</button>
</form>

<div id="result"></div>

<div id="charts_container">
  <div id="chart_div"></div>
  <div id="pie_chart_div"></div>
</div>

<!-- Google Charts -->
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

<script>
  google.charts.load('current', {'packages':['corechart']});
  google.charts.setOnLoadCallback(() => {});

  const form = document.getElementById('analysisForm');
  const resultDiv = document.getElementById('result');

  function clearErrors() {
    ['companyName','revenue','expenses','employees','avgAbsent','production'].forEach(id => {
      document.getElementById('error-' + id).innerText = '';
    });
  }

  function validate() {
    clearErrors();
    let valid = true;
    const companyName = document.getElementById('companyName').value.trim();
    const revenue = +document.getElementById('revenue').value;
    const expenses = +document.getElementById('expenses').value;
    const employees = +document.getElementById('employees').value;
    const avgAbsent = +document.getElementById('avgAbsent').value;
    const production = +document.getElementById('production').value;

    if(companyName === '') {
      document.getElementById('error-companyName').innerText = 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©';
      valid = false;
    }
    if(isNaN(revenue) || revenue < 0) {
      document.getElementById('error-revenue').innerText = 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¥ÙŠØ±Ø§Ø¯Ø§Øª ØµØ­ÙŠØ­Ø© (0 Ø£Ùˆ Ø£ÙƒØ«Ø±)';
      valid = false;
    }
    if(isNaN(expenses) || expenses < 0) {
      document.getElementById('error-expenses').innerText = 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…ØµØ§Ø±ÙŠÙ ØµØ­ÙŠØ­Ø© (0 Ø£Ùˆ Ø£ÙƒØ«Ø±)';
      valid = false;
    }
    if(isNaN(employees) || employees < 1) {
      document.getElementById('error-employees').innerText = 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ø¯Ø¯ Ù…ÙˆØ¸ÙÙŠÙ† ØµØ­ÙŠØ­ (1 Ø£Ùˆ Ø£ÙƒØ«Ø±)';
      valid = false;
    }
    if(isNaN(avgAbsent) || avgAbsent < 0 || avgAbsent > employees) {
      document.getElementById('error-avgAbsent').innerText = 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ØºÙŠØ§Ø¨ ØµØ­ÙŠØ­ (0 Ø£Ùˆ Ø£ÙƒØ«Ø± ÙˆØ£Ù‚Ù„ Ù…Ù† Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†)';
      valid = false;
    }
    if(isNaN(production) || production < 0) {
      document.getElementById('error-production').innerText = 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¥Ù†ØªØ§Ø¬ ØµØ­ÙŠØ­ (0 Ø£Ùˆ Ø£ÙƒØ«Ø±)';
      valid = false;
    }
    return valid;
  }

  function getSelectedOptions(id) {
    const select = document.getElementById(id);
    return Array.from(select.selectedOptions).map(opt => opt.value);
  }

  form.addEventListener('submit', e => {
    e.preventDefault();
    if(!validate()) {
      resultDiv.innerText = '';
      return;
    }

    // Ø¬Ù„Ø¨ Ø§Ù„Ù‚ÙŠÙ…
    const name = document.getElementById('companyName').value.trim();
    const revenue = +document.getElementById('revenue').value;
    const expenses = +document.getElementById('expenses').value;
    const employees = +document.getElementById('employees').value;
    const avgAbsent = +document.getElementById('avgAbsent').value;
    const production = +document.getElementById('production').value;
    const clientsCountVal = document.getElementById('clientsCount').value;
    const clientsCount = clientsCountVal ? +clientsCountVal : null;
    const strengths = getSelectedOptions('strengths');
    const weaknesses = getSelectedOptions('weaknesses');
    const opportunities = getSelectedOptions('opportunities');
    const threats = getSelectedOptions('threats');

    // Ø­Ø³Ø§Ø¨Ø§Øª
    const absenceRate = ((avgAbsent / employees) * 100).toFixed(2);
    const profit = revenue - expenses;
    const presentEmployees = employees - avgAbsent;
    const productivity = presentEmployees > 0 ? (production / presentEmployees).toFixed(2) : 0;
    const profitMargin = revenue > 0 ? ((profit / revenue) * 100).toFixed(2) : 0;
    const expenseRatio = revenue > 0 ? ((expenses / revenue) * 100).toFixed(2) : 0;
    const breakEven = expenses === 0 ? 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' : (expenses / (profitMargin / 100)).toFixed(2);

    // Ù…Ø¤Ø´Ø± Ø§Ù„Ø£Ø¯Ø§Ø¡ KPI
    let kpi = 50;
    if(profit > 0) kpi += 25; else kpi -= 15;
    if(productivity >= 10) kpi += 20; else if(productivity >= 5) kpi += 10; else kpi -= 10;
    if(absenceRate <= 5) kpi += 10; else if(absenceRate <= 10) kpi += 5; else kpi -= 20;
    if(kpi > 100) kpi = 100;
    if(kpi < 0) kpi = 0;

    // ØªÙ‚Ø±ÙŠØ± Ù†ØµÙŠ
    let report = `ğŸ“Š ØªÙ‚Ø±ÙŠØ± Ø£Ø¯Ø§Ø¡ Ø´Ø±ÙƒØ©: ${name}\n\n`;
    report += `ğŸ’° Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©: ${revenue}\n`;
    report += `ğŸ’¸ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ Ø§Ù„Ø´Ù‡Ø±ÙŠØ©: ${expenses}\n`;
    report += `ğŸ“ˆ Ø§Ù„Ø±Ø¨Ø­/Ø§Ù„Ø®Ø³Ø§Ø±Ø©: ${profit > 0 ? 'Ø±Ø¨Ø­' : 'Ø®Ø³Ø§Ø±Ø©'} Ø¨Ù…Ù‚Ø¯Ø§Ø± ${Math.abs(profit)}\n`;
    report += `ğŸ”¹ Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­: ${profitMargin}%\n`;
    report += `ğŸ”¹ Ù†Ø³Ø¨Ø© Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ Ù„Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª: ${expenseRatio}%\n\n`;
    report += `ğŸ‘¥ Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†: ${employees}\n`;
    report += `ğŸš¶â€â™‚ï¸ Ù…ØªÙˆØ³Ø· Ø§Ù„ØºÙŠØ§Ø¨ Ø§Ù„ÙŠÙˆÙ…ÙŠ: ${avgAbsent} (${absenceRate}%)\n`;
    report += `ğŸ­ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ù†ØªØ§Ø¬: ${production}\n`;
    report += `âš™ï¸ Ø¥Ù†ØªØ§Ø¬ÙŠØ© Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ø­Ø§Ø¶Ø±: ${productivity} ÙˆØ­Ø¯Ø©/Ù…ÙˆØ¸Ù\n`;
    report += `ğŸ“‰ Ù†Ù‚Ø·Ø© Ø§Ù„ØªØ¹Ø§Ø¯Ù„ (Break-even): ${breakEven}\n\n`;
    if(clientsCount !== null) {
      report += `ğŸ‘¨â€ğŸ’¼ Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡: ${clientsCount}\n\n`;
    }
    report += `ğŸ“‹ ØªØ­Ù„ÙŠÙ„ SWOT:\n`;
    if(strengths.length) report += `âœ”ï¸ Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ©:\n - ${strengths.join('\n - ')}\n`;
    if(weaknesses.length) report += `âŒ Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù:\n - ${weaknesses.join('\n - ')}\n`;
    if(opportunities.length) report += `ğŸŒŸ Ø§Ù„ÙØ±Øµ:\n - ${opportunities.join('\n - ')}\n`;
    if(threats.length) report += `âš ï¸ Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯Ø§Øª:\n - ${threats.join('\n - ')}\n`;

    // Ø®Ø·Ø© Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø© Ø¨Ù†Ø§Ø¡ Ø¹Ù„Ù‰ KPI
    report += `\nğŸ“ Ø®Ø·Ø© Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©:\n`;
    if(kpi >= 80) {
      report += "Ø£Ø¯Ø§Ø¡ Ù…Ù…ØªØ§Ø²ØŒ Ø§Ø³ØªÙ…Ø± ÙÙŠ ØªØ­Ø³ÙŠÙ† Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ© ÙˆØªØ¹Ø²ÙŠØ² Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§ØªÙƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ©.\n";
    } else if(kpi >= 60) {
      report += "Ø£Ø¯Ø§Ø¡ Ø¬ÙŠØ¯ØŒ Ù„ÙƒÙ† ÙŠÙÙ†ØµØ­ Ø¨Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ ÙˆØªØ­Ø³ÙŠÙ† Ø¥Ù†ØªØ§Ø¬ÙŠØ© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†.\n";
    } else {
      report += "Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙŠØ­ØªØ§Ø¬ Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª ÙƒØ¨ÙŠØ±Ø©ØŒ Ø±ÙƒØ² Ø¹Ù„Ù‰ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙØŒ ØªØ­Ø³ÙŠÙ† Ø¨ÙŠØ¦Ø© Ø§Ù„Ø¹Ù…Ù„ØŒ ÙˆØªØ·ÙˆÙŠØ± Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†.\n";
    }

    // Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ±
    resultDiv.innerText = report;

    // Ø±Ø³Ù… Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ©
    google.charts.setOnLoadCallback(() => {
      drawBarChart(profitMargin, expenseRatio, absenceRate, productivity, kpi);
      drawPieChart(strengths.length, weaknesses.length, opportunities.length, threats.length);
    });
  });

  // Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ Ø¹Ù…ÙˆØ¯ÙŠ Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ù…Ø§Ù„ÙŠØ© ÙˆØ£Ø¯Ø§Ø¡
  function drawBarChart(profitMargin, expenseRatio, absenceRate, productivity, kpi) {
    const data = google.visualization.arrayToDataTable([
      ['Ø§Ù„Ù…Ø¤Ø´Ø±', 'Ø§Ù„Ù‚ÙŠÙ…Ø©'],
      ['Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­ %', parseFloat(profitMargin)],
      ['Ù†Ø³Ø¨Ø© Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ %', parseFloat(expenseRatio)],
      ['Ù…Ø¹Ø¯Ù„ Ø§Ù„ØºÙŠØ§Ø¨ %', parseFloat(absenceRate)],
      ['Ø¥Ù†ØªØ§Ø¬ÙŠØ© Ø§Ù„Ù…ÙˆØ¸Ù', parseFloat(productivity)],
      ['Ù…Ø¤Ø´Ø± Ø§Ù„Ø£Ø¯Ø§Ø¡ KPI', parseFloat(kpi)],
    ]);

    const options = {
      title: 'Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ø§Ù„ÙŠ ÙˆØ§Ù„Ø¥Ø¯Ø§Ø±ÙŠ',
      legend: { position: 'none' },
      colors: ['#1a73e8'],
      vAxis: { minValue: 0 },
      chartArea: {width: '70%', height: '70%'},
      fontName: 'Segoe UI',
    };

    const chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
    chart.draw(data, options);
  }

  // Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ Ø¯Ø§Ø¦Ø±ÙŠ Ù„ØªØ­Ù„ÙŠÙ„ SWOT
  function drawPieChart(strengthsCount, weaknessesCount, opportunitiesCount, threatsCount) {
    const data = google.visualization.arrayToDataTable([
      ['Ø§Ù„Ø¹Ù†ØµØ±', 'Ø§Ù„Ø¹Ø¯Ø¯'],
      ['Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ©', strengthsCount],
      ['Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù', weaknessesCount],
      ['Ø§Ù„ÙØ±Øµ', opportunitiesCount],
      ['Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯Ø§Øª', threatsCount],
    ]);

    const options = {
      title: 'ØªØ­Ù„ÙŠÙ„ SWOT',
      pieHole: 0.4,
      colors: ['#4caf50', '#f44336', '#ff9800', '#9c27b0'],
      fontName: 'Segoe UI',
      chartArea: {width: '80%', height: '80%'},
    };

    const chart = new google.visualization.PieChart(document.get
