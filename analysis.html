<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ - Ø´Ø±ÙƒØ© Ø±ÙˆØ§Ø¡</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f4f8;
      margin: 0; padding: 20px;
      color: #333;
    }
    h1 {
      text-align: center;
      color: #0a4a7b;
      margin-bottom: 20px;
    }
    form {
      max-width: 700px;
      margin: auto;
      background: #fff;
      padding: 20px 30px;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0,0,0,0.1);
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }
    input, textarea {
      width: 100%;
      padding: 10px;
      margin-top: 6px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 1rem;
    }
    button {
      margin-top: 25px;
      width: 100%;
      padding: 12px;
      font-size: 1.1rem;
      background: #0a4a7b;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    button:hover {
      background: #083a5d;
    }
    #result {
      max-width: 700px;
      margin: 30px auto;
      background: #e6f0ff;
      padding: 20px;
      border-radius: 10px;
      white-space: pre-line;
      font-weight: bold;
      color: #0a4a7b;
    }
    #map {
      width: 100%;
      height: 300px;
      margin-top: 30px;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0,0,0,0.1);
    }
    #chart_div {
      max-width: 700px;
      margin: 30px auto;
    }
  </style>
</head>
<body>

<h1>ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ø£Ø¯Ø§Ø¡ Ø´Ø±ÙƒØªÙƒ</h1>

<form id="analysisForm">

  <label>Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©</label>
  <input type="text" id="companyName" required placeholder="Ù…Ø«Ù„Ø§Ù‹: Ø±ÙˆØ§Ø¡ Ù„Ù„Ø§Ø³ØªØ´Ø§Ø±Ø§Øª">

  <label>Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø´Ø±ÙƒØ© (Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©)</label>
  <input type="text" id="companyLocation" required placeholder="Ù…Ø«Ù„Ø§Ù‹: Ø§Ù„Ø²Ù‚Ø§Ø²ÙŠÙ‚">

  <label>Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ© (Ø¨Ø§Ù„Ø¬Ù†ÙŠÙ‡)</label>
  <input type="number" id="revenue" required placeholder="Ù…Ø«Ù„Ø§Ù‹: 150000">

  <label>Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ Ø§Ù„Ø´Ù‡Ø±ÙŠØ© (Ø¨Ø§Ù„Ø¬Ù†ÙŠÙ‡)</label>
  <input type="number" id="expenses" required placeholder="Ù…Ø«Ù„Ø§Ù‹: 120000">

  <label>Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</label>
  <input type="number" id="employees" required placeholder="Ù…Ø«Ù„Ø§Ù‹: 25">

  <label>Ù…ØªÙˆØ³Ø· Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„ØºØ§Ø¦Ø¨ÙŠÙ† ÙŠÙˆÙ…ÙŠÙ‹Ø§</label>
  <input type="number" id="avgAbsent" required placeholder="Ù…Ø«Ù„Ø§Ù‹: 3">

  <label>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ø´Ù‡Ø±ÙŠ (Ø¹Ø¯Ø¯ Ø§Ù„ÙˆØ­Ø¯Ø§Øª Ø£Ùˆ Ø§Ù„Ø®Ø¯Ù…Ø§Øª)</label>
  <input type="number" id="production" required placeholder="Ù…Ø«Ù„Ø§Ù‹: 500">

  <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
  <input type="number" id="clientsCount" placeholder="Ù…Ø«Ù„Ø§Ù‹: 200">

  <label>ÙˆØµÙ Ù…Ø®ØªØµØ± Ù„Ù„Ù†Ø´Ø§Ø·</label>
  <textarea id="activityDesc" rows="3" placeholder="Ù…Ø«Ù„Ø§Ù‹: Ø®Ø¯Ù…Ø§Øª Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø´Ø±ÙŠØ©ØŒ ØªÙˆØ¸ÙŠÙØŒ Ø§Ø³ØªØ´Ø§Ø±Ø§Øª Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©"></textarea>

  <button type="submit">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ù„ÙŠÙ„</button>
</form>

<div id="result"></div>

<div id="map"></div>

<div id="chart_div"></div>

<!-- Google Charts -->
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<!-- Google Maps API (Ø¶Ø¹ Ù…ÙØªØ§Ø­Ùƒ Ù‡Ù†Ø§) -->
<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_API_KEY&libraries=places"></script>

<script>
  // ØªØ­Ù…ÙŠÙ„ Ù…ÙƒØªØ¨Ø© Google Charts
  google.charts.load('current', {'packages':['corechart']});

  document.getElementById('analysisForm').addEventListener('submit', function(e){
    e.preventDefault();

    // Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    const name = document.getElementById('companyName').value.trim();
    const location = document.getElementById('companyLocation').value.trim();
    const revenue = +document.getElementById('revenue').value;
    const expenses = +document.getElementById('expenses').value;
    const employees = +document.getElementById('employees').value;
    const avgAbsent = +document.getElementById('avgAbsent').value;
    const production = +document.getElementById('production').value;
    const clientsCount = document.getElementById('clientsCount').value ? +document.getElementById('clientsCount').value : null;
    const activityDesc = document.getElementById('activityDesc').value.trim();

    // Ø­Ø³Ø§Ø¨ Ù†Ø³Ø¨Ø© Ø§Ù„ØºÙŠØ§Ø¨
    const absenceRate = ((avgAbsent / employees) * 100).toFixed(2);

    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø¨Ø­ Ø£Ùˆ Ø§Ù„Ø®Ø³Ø§Ø±Ø©
    const profit = revenue - expenses;

    // Ø¥Ù†ØªØ§Ø¬ÙŠØ© Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ø­Ø§Ø¶Ø±
    const presentEmployees = employees - avgAbsent;
    const productivity = presentEmployees > 0 ? (production / presentEmployees).toFixed(2) : 0;

    // ØªØ­Ù„ÙŠÙ„ SWOT Ø¨Ø³ÙŠØ· ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ÙˆØµÙ Ø§Ù„Ù†Ø´Ø§Ø·
    let strengths = [], weaknesses = [], opportunities = [], threats = [];

    if(activityDesc){
      const desc = activityDesc.toLowerCase();
      if(desc.includes('Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø´Ø±ÙŠØ©') || desc.includes('ØªÙˆØ¸ÙŠÙ')){
        strengths.push("Ø®Ø¨Ø±Ø© ÙÙŠ Ø§Ù„ØªÙˆØ¸ÙŠÙ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©.");
        opportunities.push("Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø·Ù„Ø¨ Ø¹Ù„Ù‰ Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©.");
      }
      if(desc.includes('Ø§Ø³ØªØ´Ø§Ø±Ø§Øª')){
        strengths.push("Ø®Ø¨Ø±Ø© ÙÙŠ ØªÙ‚Ø¯ÙŠÙ… Ø§Ø³ØªØ´Ø§Ø±Ø§Øª Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© ÙˆØ¥Ø¯Ø§Ø±ÙŠØ©.");
        opportunities.push("ØªÙˆØ³Ø¹ Ø§Ù„Ø³ÙˆÙ‚ Ù„Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø§Ø³ØªØ´Ø§Ø±ÙŠØ©.");
      }
      if(desc.includes('ØªØ­Ù„ÙŠÙ„')){
        strengths.push("ØªÙ‚Ø¯ÙŠÙ… Ø®Ø¯Ù…Ø§Øª ØªØ­Ù„ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©.");
      }
      if(desc.includes('ØµØºÙŠØ±Ø©') || desc.includes('Ù…ØªÙˆØ³Ø·Ø©')){
        weaknesses.push("Ù…ÙˆØ§Ø±Ø¯ Ù…Ø­Ø¯ÙˆØ¯Ø© Ù†Ø³Ø¨ÙŠØ§Ù‹ Ù„Ù„Ø´Ø±ÙƒØ§Øª Ø§Ù„ØµØºÙŠØ±Ø© ÙˆØ§Ù„Ù…ØªÙˆØ³Ø·Ø©.");
      }
      if(desc.includes('ØªÙ†Ø§ÙØ³')){
        threats.push("Ù…Ù†Ø§ÙØ³Ø© Ø¹Ø§Ù„ÙŠØ© ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚.");
      }
    } else {
      weaknesses.push("Ø§Ù„ÙˆØµÙ ØºÙŠØ± Ù…ØªÙˆÙØ± Ù„ØªØ­Ø¯ÙŠØ¯ Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ© ÙˆØ§Ù„Ø¶Ø¹Ù.");
    }

    // Ø¥Ø¹Ø¯Ø§Ø¯ ØªÙ‚Ø±ÙŠØ± Ù†ØµÙŠ
    let report = `ğŸ“Š ØªÙ‚Ø±ÙŠØ± Ø£Ø¯Ø§Ø¡ Ø´Ø±ÙƒØ©: ${name}\n\n`;

    report += `ğŸ“ Ø§Ù„Ù…ÙˆÙ‚Ø¹: ${location}\n`;
    report += `ğŸ’° Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©: ${revenue} Ø¬Ù†ÙŠÙ‡\n`;
    report += `ğŸ’¸ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ Ø§Ù„Ø´Ù‡Ø±ÙŠØ©: ${expenses} Ø¬Ù†ÙŠÙ‡\n`;
    report += `ğŸ“ˆ Ø§Ù„Ø±Ø¨Ø­/Ø§Ù„Ø®Ø³Ø§Ø±Ø©: ${profit > 0 ? 'Ø±Ø¨Ø­' : 'Ø®Ø³Ø§Ø±Ø©'} Ù…Ù‚Ø¯Ø§Ø±Ù‡Ø§ ${Math.abs(profit)} Ø¬Ù†ÙŠÙ‡\n\n`;

    report += `ğŸ‘¥ Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†: ${employees}\n`;
    report += `ğŸš¶â€â™‚ï¸ Ù…ØªÙˆØ³Ø· Ø§Ù„ØºÙŠØ§Ø¨ Ø§Ù„ÙŠÙˆÙ…ÙŠ: ${avgAbsent} (${absenceRate}%)\n`;
    report += `ğŸ­ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ù†ØªØ§Ø¬: ${production}\n`;
    report += `âš™ï¸ Ø¥Ù†ØªØ§Ø¬ÙŠØ© Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ø­Ø§Ø¶Ø±: ${productivity} ÙˆØ­Ø¯Ø©/Ù…ÙˆØ¸Ù\n\n`;

    if(clientsCount !== null){
      report += `ğŸ‘¨â€ğŸ’¼ Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡: ${clientsCount}\n\n`;
    }

    // Ø¥Ø¶Ø§ÙØ© ØªØ­Ù„ÙŠÙ„ SWOT
    report += `ğŸ“‹ ØªØ­Ù„ÙŠÙ„ SWOT:\n`;

    if(strengths.length) report += `âœ”ï¸ Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ©:\n - ${strengths.join('\n - ')}\n`;
    if(weaknesses.length) report += `âš ï¸ Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù:\n - ${weaknesses.join('\n - ')}\n`;
    if(opportunities.length) report += `ğŸŒŸ Ø§Ù„ÙØ±Øµ:\n - ${opportunities.join('\n - ')}\n`;
    if(threats.length) report += `ğŸš¨ Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯Ø§Øª:\n - ${threats.join('\n - ')}\n`;

    document.getElementById('result').innerText = report;

    // Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ Ù„Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
      var data = google.visualization.arrayToDataTable([
        ['Ø§Ù„Ù…Ø¤Ø´Ø±', 'Ø§Ù„Ù‚ÙŠÙ…Ø©', { role: 'style' }],
        ['Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª', revenue, '#4CAF50'],
        ['Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ', expenses, '#f44336'],
        ['Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†', employees, '#2196F3'],
        ['Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ©', parseFloat(productivity), '#FFC107'],
        ['Ù†Ø³Ø¨Ø© Ø§Ù„ØºÙŠØ§Ø¨', parseFloat(absenceRate), '#9E9E9E']
      ]);

      var options = {
        title: 'Ù…Ø¤Ø´Ø±Ø§Øª Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø´Ø±ÙƒØ©',
        legend: { position: 'none' },
        vAxis: { minValue: 0 },
        chartArea: {width: '70%', height: '70%'}
      };

      var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
      chart.draw(data, options);
    }

    // Ø¹Ø±Ø¶ Ø®Ø±ÙŠØ·Ø© Google Maps Ø¨Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø´Ø±ÙƒØ© ÙˆÙ†Ù‚Ø§Ø· Ù†Ù…ÙˆØ°Ø¬ÙŠØ© Ù„Ù„Ù…Ù†Ø§ÙØ³ÙŠÙ†
    initMap(location);

  });

  function initMap(locationName) {
    var geocoder = new google.maps.Geocoder();
    var mapDiv = document.getElementById('map');
    mapDiv.innerHTML = 'Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø±ÙŠØ·Ø©...';

    geocoder.geocode( { 'address': locationName}, function(results, status) {
      if (status === 'OK') {
        var map = new google.maps.Map(mapDiv, {
          zoom: 12,
          center: results[0].geometry.location
        });

        // Ø¹Ù„Ø§Ù…Ø© Ø¹Ù„Ù‰ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø´Ø±ÙƒØ©
        var marker = new google.maps.Marker({
          map: map,
          position: results[0].geometry.location,
          title: 'Ù…ÙˆÙ‚Ø¹ Ø´Ø±ÙƒØªÙƒ'
        });

        // Ù†Ù‚Ø§Ø· Ù…Ù†Ø§ÙØ³ÙŠÙ† Ù†Ù…ÙˆØ°Ø¬ÙŠØ© (Ù…ÙˆØ§Ù‚Ø¹ ÙˆÙ‡Ù…ÙŠØ© Ù‚Ø±ÙŠØ¨Ø©)
        var competitors = [
          {lat: results[0].geometry.location.lat() + 0.01, lng: results[0].geometry.location.lng() + 0.01, title: 'Ù…Ù†Ø§ÙØ³ 1'},
          {lat: results[0].geometry.location.lat() - 0.008, lng: results[0].geometry.location.lng() + 0.012, title: 'Ù…Ù†Ø§ÙØ³ 2'},
          {lat: results[0].geometry.location.lat() + 0.012, lng: results[0].geometry.location.lng() - 0.015, title: 'Ù…Ù†Ø§ÙØ³ 3'}
        ];

        competitors.forEach(function(c){
          new google.maps.Marker({
            map: map,
            position: {lat: c.lat, lng: c.lng},
            icon: 'http://maps.google.com/mapfiles/ms/icons/red-dot.png',
            title: c.title
          });
        });

        mapDiv.innerHTML = '';
      } else {
        mapDiv.innerHTML = 'ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø±ÙŠØ·Ø©: ' + status;
      }
    });
  }
</script>

</body>
</html>
