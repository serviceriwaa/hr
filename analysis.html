<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<title>ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ø´Ø±ÙƒØ© Ø±ÙˆØ§Ø¡ - Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f0f4f8;
    margin: 0; padding: 20px;
    color: #333;
  }
  h1 {
    text-align: center;
    color: #0a4a7b;
    margin-bottom: 20px;
  }
  form {
    max-width: 750px;
    margin: auto;
    background: #fff;
    padding: 20px 30px;
    border-radius: 10px;
    box-shadow: 0 0 15px rgba(0,0,0,0.1);
  }
  label {
    display: block;
    margin-top: 15px;
    font-weight: bold;
    position: relative;
  }
  label .tooltip {
    cursor: help;
    color: #0a4a7b;
    font-weight: normal;
    margin-right: 5px;
    border-bottom: 1px dotted #0a4a7b;
  }
  input, select {
    width: 100%;
    padding: 10px;
    margin-top: 6px;
    border: 1px solid #ccc;
    border-radius: 6px;
    font-size: 1rem;
  }
  select[multiple] {
    height: 120px;
  }
  button {
    margin-top: 25px;
    width: 100%;
    padding: 12px;
    font-size: 1.1rem;
    background: #0a4a7b;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
  }
  button:hover {
    background: #083a5d;
  }
  #result {
    max-width: 750px;
    margin: 30px auto;
    background: #e6f0ff;
    padding: 20px;
    border-radius: 10px;
    white-space: pre-line;
    font-weight: bold;
    color: #0a4a7b;
  }
  #charts_container {
    max-width: 750px;
    margin: 30px auto;
    display: flex;
    justify-content: space-around;
    flex-wrap: wrap;
    gap: 30px;
  }
  #chart_div, #pie_chart_div {
    width: 350px;
    height: 300px;
  }
  p.note {
    text-align: center;
    font-size: 0.9rem;
    color: #666;
    margin-top: 5px;
  }
  .error {
    color: red;
    font-size: 0.9rem;
    margin-top: 4px;
  }
</style>
</head>
<body>

<h1>ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ø£Ø¯Ø§Ø¡ Ø´Ø±ÙƒØªÙƒ Ù…Ø¹ Ø®Ø·Ø© Ø¹Ù…Ù„ Ù…Ù‚ØªØ±Ø­Ø© (Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰)</h1>

<form id="analysisForm" novalidate>

  <label>Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©
    <span class="tooltip" title="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø´Ø±ÙƒØªÙƒ Ø§Ù„Ø±Ø³Ù…ÙŠ">?</span>
  </label>
  <input type="text" id="companyName" required placeholder="Ù…Ø«Ù„Ø§Ù‹: Ø±ÙˆØ§Ø¡ Ù„Ù„Ø§Ø³ØªØ´Ø§Ø±Ø§Øª">
  <div id="error-companyName" class="error"></div>

  <label>Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©
    <span class="tooltip" title="Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ© Ø§Ù„ØªÙŠ ØªØ­Ù‚Ù‚Ù‡Ø§ Ø´Ø±ÙƒØªÙƒ">?</span>
  </label>
  <input type="number" id="revenue" min="0" required placeholder="Ù…Ø«Ù„Ø§Ù‹: 150000">
  <div id="error-revenue" class="error"></div>

  <label>Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ Ø§Ù„Ø´Ù‡Ø±ÙŠØ©
    <span class="tooltip" title="Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ Ø§Ù„Ø´Ù‡Ø±ÙŠØ© Ø§Ù„ØªÙŠ ØªØªØ­Ù…Ù„Ù‡Ø§ Ø´Ø±ÙƒØªÙƒ">?</span>
  </label>
  <input type="number" id="expenses" min="0" required placeholder="Ù…Ø«Ù„Ø§Ù‹: 120000">
  <div id="error-expenses" class="error"></div>

  <p class="note">(ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„ØªÙŠ ØªØ³ØªØ®Ø¯Ù…Ù‡Ø§ Ø´Ø±ÙƒØªÙƒ)</p>

  <label>Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
    <span class="tooltip" title="Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ø¯Ø§Ø¦Ù…ÙŠÙ† ÙÙŠ Ø´Ø±ÙƒØªÙƒ">?</span>
  </label>
  <input type="number" id="employees" min="1" required placeholder="Ù…Ø«Ù„Ø§Ù‹: 25">
  <div id="error-employees" class="error"></div>

  <label>Ù…ØªÙˆØ³Ø· Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„ØºØ§Ø¦Ø¨ÙŠÙ† ÙŠÙˆÙ…ÙŠÙ‹Ø§
    <span class="tooltip" title="Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ ØºÙŠØ§Ø¨Ù‡Ù… ÙŠÙˆÙ…ÙŠÙ‹Ø§ ÙÙŠ Ø§Ù„Ù…ØªÙˆØ³Ø·">?</span>
  </label>
  <input type="number" id="avgAbsent" min="0" required placeholder="Ù…Ø«Ù„Ø§Ù‹: 3">
  <div id="error-avgAbsent" class="error"></div>

  <label>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ø´Ù‡Ø±ÙŠ (Ø¹Ø¯Ø¯ Ø§Ù„ÙˆØ­Ø¯Ø§Øª Ø£Ùˆ Ø§Ù„Ø®Ø¯Ù…Ø§Øª)
    <span class="tooltip" title="ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø£Ùˆ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„ØªÙŠ ØªÙ‚Ø¯Ù…Ù‡Ø§ Ø´Ù‡Ø±ÙŠÙ‹Ø§">?</span>
  </label>
  <input type="number" id="production" min="0" required placeholder="Ù…Ø«Ù„Ø§Ù‹: 500">
  <div id="error-production" class="error"></div>

  <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
    <span class="tooltip" title="Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ø­Ø§Ù„ÙŠÙŠÙ†">?</span>
  </label>
  <input type="number" id="clientsCount" min="0" placeholder="Ù…Ø«Ù„Ø§Ù‹: 200">

  <label>Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ© (Ø§Ø®ØªØ± Ù…Ø§ ÙŠÙ†Ø·Ø¨Ù‚)
    <span class="tooltip" title="Ø§Ø®ØªØ± Ù…Ù† Ø£Ù‡Ù… Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ© ÙÙŠ Ø´Ø±ÙƒØªÙƒ">?</span>
  </label>
  <select id="strengths" multiple>
    <option value="Ø®Ø¨Ø±Ø© Ø¹Ø§Ù„ÙŠØ© ÙÙŠ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©">Ø®Ø¨Ø±Ø© Ø¹Ø§Ù„ÙŠØ© ÙÙŠ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©</option>
    <option value="Ø¹Ù„Ø§Ù‚Ø§Øª Ù‚ÙˆÙŠØ© Ù…Ø¹ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡">Ø¹Ù„Ø§Ù‚Ø§Øª Ù‚ÙˆÙŠØ© Ù…Ø¹ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</option>
    <option value="Ø®Ø¯Ù…Ø§Øª ØªØ­Ù„ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©">Ø®Ø¯Ù…Ø§Øª ØªØ­Ù„ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©</option>
    <option value="ØªÙˆØ§Ø¬Ø¯ ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚ Ù„ÙØªØ±Ø© Ø·ÙˆÙŠÙ„Ø©">ØªÙˆØ§Ø¬Ø¯ ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚ Ù„ÙØªØ±Ø© Ø·ÙˆÙŠÙ„Ø©</option>
  </select>

  <label>Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù (Ø§Ø®ØªØ± Ù…Ø§ ÙŠÙ†Ø·Ø¨Ù‚)
    <span class="tooltip" title="Ø§Ø®ØªØ± Ù…Ù† Ø£Ø¨Ø±Ø² Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù ÙÙŠ Ø´Ø±ÙƒØªÙƒ">?</span>
  </label>
  <select id="weaknesses" multiple>
    <option value="Ø¶Ø¹Ù ÙÙŠ Ø§Ù„ØªØ³ÙˆÙŠÙ‚ Ø§Ù„Ø±Ù‚Ù…ÙŠ">Ø¶Ø¹Ù ÙÙŠ Ø§Ù„ØªØ³ÙˆÙŠÙ‚ Ø§Ù„Ø±Ù‚Ù…ÙŠ</option>
    <option value="Ù†Ù‚Øµ ÙÙŠ Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ù„Ù„Ù…ÙˆØ¸ÙÙŠÙ†">Ù†Ù‚Øµ ÙÙŠ Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ù„Ù„Ù…ÙˆØ¸ÙÙŠÙ†</option>
    <option value="Ø§Ø¹ØªÙ…Ø§Ø¯ Ø¹Ø§Ù„ÙŠ Ø¹Ù„Ù‰ Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ø­Ø¯Ø¯ÙŠÙ†">Ø§Ø¹ØªÙ…Ø§Ø¯ Ø¹Ø§Ù„ÙŠ Ø¹Ù„Ù‰ Ù…ÙˆØ¸ÙÙŠÙ† Ù…Ø­Ø¯Ø¯ÙŠÙ†</option>
    <option value="Ù…ÙˆØ§Ø±Ø¯ Ù…Ø§Ù„ÙŠØ© Ù…Ø­Ø¯ÙˆØ¯Ø©">Ù…ÙˆØ§Ø±Ø¯ Ù…Ø§Ù„ÙŠØ© Ù…Ø­Ø¯ÙˆØ¯Ø©</option>
  </select>

  <label>Ø§Ù„ÙØ±Øµ (Ø§Ø®ØªØ± Ù…Ø§ ÙŠÙ†Ø·Ø¨Ù‚)
    <span class="tooltip" title="Ø§Ø®ØªØ± Ù…Ù† Ø§Ù„ÙØ±Øµ Ø§Ù„Ù…ØªØ§Ø­Ø© ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚">?</span>
  </label>
  <select id="opportunities" multiple>
    <option value="Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø·Ù„Ø¨ Ø¹Ù„Ù‰ Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©">Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø·Ù„Ø¨ Ø¹Ù„Ù‰ Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©</option>
    <option value="ØªÙˆØ³Ø¹ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø±Ù‚Ù…ÙŠ">ØªÙˆØ³Ø¹ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø±Ù‚Ù…ÙŠ</option>
    <option value="ØªØ·ÙˆÙŠØ± ØªÙ‚Ù†ÙŠØ§Øª ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª">ØªØ·ÙˆÙŠØ± ØªÙ‚Ù†ÙŠØ§Øª ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</option>
    <option value="Ø´Ø±Ø§ÙƒØ§Øª Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©">Ø´Ø±Ø§ÙƒØ§Øª Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©</option>
  </select>

  <label>Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯Ø§Øª (Ø§Ø®ØªØ± Ù…Ø§ ÙŠÙ†Ø·Ø¨Ù‚)
    <span class="tooltip" title="Ø§Ø®ØªØ± Ù…Ù† Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯Ø§Øª Ø§Ù„ØªÙŠ ØªÙˆØ§Ø¬Ù‡Ù‡Ø§ Ø´Ø±ÙƒØªÙƒ">?</span>
  </label>
  <select id="threats" multiple>
    <option value="Ù…Ù†Ø§ÙØ³Ø© Ø´Ø¯ÙŠØ¯Ø© ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚">Ù…Ù†Ø§ÙØ³Ø© Ø´Ø¯ÙŠØ¯Ø© ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚</option>
    <option value="ØªØºÙŠØ±Ø§Øª ÙÙŠ Ø§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ†">ØªØºÙŠØ±Ø§Øª ÙÙŠ Ø§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ†</option>
    <option value="ØªØ±Ø§Ø¬Ø¹ ÙÙŠ Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯">ØªØ±Ø§Ø¬Ø¹ ÙÙŠ Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯</option>
    <option value="ØµØ¹ÙˆØ¨Ø© ÙÙŠ Ø¬Ø°Ø¨ Ø§Ù„Ù…ÙˆØ§Ù‡Ø¨">ØµØ¹ÙˆØ¨Ø© ÙÙŠ Ø¬Ø°Ø¨ Ø§Ù„Ù…ÙˆØ§Ù‡Ø¨</option>
  </select>

  <button type="submit">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ù„ÙŠÙ„</button>
</form>

<div id="result"></div>

<div id="charts_container">
  <div id="chart_div"></div>
  <div id="pie_chart_div"></div>
</div>

<!-- Google Charts -->
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

<script>
  google.charts.load('current', {'packages':['corechart']});

  const form = document.getElementById('analysisForm');
  const resultDiv = document.getElementById('result');

  function clearErrors() {
    ['companyName','revenue','expenses','employees','avgAbsent','production'].forEach(id => {
      document.getElementById('error-' + id).innerText = '';
    });
  }

  function validate() {
    clearErrors();
    let valid = true;

    const companyName = document.getElementById('companyName').value.trim();
    const revenue = +document.getElementById('revenue').value;
    const expenses = +document.getElementById('expenses').value;
    const employees = +document.getElementById('employees').value;
    const avgAbsent = +document.getElementById('avgAbsent').value;
    const production = +document.getElementById('production').value;

    if(companyName === '') {
      document.getElementById('error-companyName').innerText = 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©';
      valid = false;
    }
    if(isNaN(revenue) || revenue < 0) {
      document.getElementById('error-revenue').innerText = 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¥ÙŠØ±Ø§Ø¯Ø§Øª ØµØ­ÙŠØ­Ø© (0 Ø£Ùˆ Ø£ÙƒØ«Ø±)';
      valid = false;
    }
    if(isNaN(expenses) || expenses < 0) {
      document.getElementById('error-expenses').innerText = 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…ØµØ§Ø±ÙŠÙ ØµØ­ÙŠØ­Ø© (0 Ø£Ùˆ Ø£ÙƒØ«Ø±)';
      valid = false;
    }
    if(isNaN(employees) || employees < 1) {
      document.getElementById('error-employees').innerText = 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ø¯Ø¯ Ù…ÙˆØ¸ÙÙŠÙ† ØµØ­ÙŠØ­ (1 Ø£Ùˆ Ø£ÙƒØ«Ø±)';
      valid = false;
    }
    if(isNaN(avgAbsent) || avgAbsent < 0 || avgAbsent > employees) {
      document.getElementById('error-avgAbsent').innerText = 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ØºÙŠØ§Ø¨ ØµØ­ÙŠØ­ (0 Ø£Ùˆ Ø£ÙƒØ«Ø± ÙˆØ£Ù‚Ù„ Ù…Ù† Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†)';
      valid = false;
    }
    if(isNaN(production) || production < 0) {
      document.getElementById('error-production').innerText = 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¥Ù†ØªØ§Ø¬ ØµØ­ÙŠØ­ (0 Ø£Ùˆ Ø£ÙƒØ«Ø±)';
      valid = false;
    }

    return valid;
  }

  function getSelectedOptions(id) {
    const select = document.getElementById(id);
    return Array.from(select.selectedOptions).map(opt => opt.value);
  }

  form.addEventListener('submit', function(e) {
    e.preventDefault();

    if(!validate()) {
      resultDiv.innerText = '';
      return;
    }

    const name = document.getElementById('companyName').value.trim();
    const revenue = +document.getElementById('revenue').value;
    const expenses = +document.getElementById('expenses').value;
    const employees = +document.getElementById('employees').value;
    const avgAbsent = +document.getElementById('avgAbsent').value;
    const production = +document.getElementById('production').value;
    const clientsCountVal = document.getElementById('clientsCount').value;
    const clientsCount = clientsCountVal ? +clientsCountVal : null;

    const strengths = getSelectedOptions('strengths');
    const weaknesses = getSelectedOptions('weaknesses');
    const opportunities = getSelectedOptions('opportunities');
    const threats = getSelectedOptions('threats');

    const absenceRate = ((avgAbsent / employees) * 100).toFixed(2);
    const profit = revenue - expenses;
    const presentEmployees = employees - avgAbsent;
    const productivity = presentEmployees > 0 ? (production / presentEmployees).toFixed(2) : 0;

    // Ù…Ø¤Ø´Ø±Ø§Øª Ù…Ø§Ù„ÙŠØ© Ø¥Ø¶Ø§ÙÙŠØ©
    const profitMargin = revenue > 0 ? ((profit / revenue) * 100).toFixed(2) : 0;
    const expenseRatio = revenue > 0 ? ((expenses / revenue) * 100).toFixed(2) : 0;
    const breakEven = expenses === 0 ? 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' : (expenses / (profitMargin / 100)).toFixed(2);

    // Ø­Ø³Ø§Ø¨ Ù…Ø¤Ø´Ø± Ø§Ù„Ø£Ø¯Ø§Ø¡ KPI (0 - 100)
    let kpi = 50;
    if(profit > 0) kpi += 25; else kpi -= 15;
    if(productivity >= 10) kpi += 20; else if(productivity >= 5) kpi += 10; else kpi -= 10;
    if(absenceRate <= 5) kpi += 10; else if(absenceRate <= 10) kpi += 5; else kpi -= 20;
    if(kpi > 100) kpi = 100;
    if(kpi < 0) kpi = 0;

    // Ø¥Ø¹Ø¯Ø§Ø¯ ØªÙ‚Ø±ÙŠØ± Ù†ØµÙŠ
    let report = `ğŸ“Š ØªÙ‚Ø±ÙŠØ± Ø£Ø¯Ø§Ø¡ Ø´Ø±ÙƒØ©: ${name}\n\n`;
    report += `ğŸ’° Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©: ${revenue}\n`;
    report += `ğŸ’¸ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ Ø§Ù„Ø´Ù‡Ø±ÙŠØ©: ${expenses}\n`;
    report += `ğŸ“ˆ Ø§Ù„Ø±Ø¨Ø­/Ø§Ù„Ø®Ø³Ø§Ø±Ø©: ${profit > 0 ? 'Ø±Ø¨Ø­' : 'Ø®Ø³Ø§Ø±Ø©'} Ø¨Ù…Ù‚Ø¯Ø§Ø± ${Math.abs(profit)}\n`;
    report += `ğŸ”¹ Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­: ${profitMargin}%\n`;
    report += `ğŸ”¹ Ù†Ø³Ø¨Ø© Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ Ù„Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª: ${expenseRatio}%\n\n`;

    report += `ğŸ‘¥ Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†: ${employees}\n`;
    report += `ğŸš¶â€â™‚ï¸ Ù…ØªÙˆØ³Ø· Ø§Ù„ØºÙŠØ§Ø¨ Ø§Ù„ÙŠÙˆÙ…ÙŠ: ${avgAbsent} (${absenceRate}%)\n`;
    report += `ğŸ­ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ù†ØªØ§Ø¬: ${production}\n`;
    report += `âš™ï¸ Ø¥Ù†ØªØ§Ø¬ÙŠØ© Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ø­Ø§Ø¶Ø±: ${productivity} ÙˆØ­Ø¯Ø©/Ù…ÙˆØ¸Ù\n`;
    report += `ğŸ“‰ Ù†Ù‚Ø·Ø© Ø§Ù„ØªØ¹Ø§Ø¯Ù„ (Break-even): ${breakEven}\n\n`;

    if(clientsCount !== null) {
      report += `ğŸ‘¨â€ğŸ’¼ Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡: ${clientsCount}\n\n`;
    }

    report += `ğŸ“‹ ØªØ­Ù„ÙŠÙ„ SWOT:\n`;
    if(strengths.length) report += `âœ”ï¸ Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ©:\n - ${
